CREATE DATABASE gearrentpro;

CREATE TABLE branch(
  branch_id VARCHAR(10) NOT NULL PRIMARY KEY,
  name VARCHAR(45) NULL,
  address VARCHAR(50) NULL,
  contact VARCHAR(15) NULL,
);

CREATE TABLE user (
    user_id VARCHAR(10) PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    role ENUM('STAFF', 'MANAGER', 'ADMIN') NOT NULL,
    branch_id VARCHAR(10),
    FOREIGN KEY(branch_id) REFERENCES branch(branch_id)
);

CREATE TABLE membership_tier (
    tier_id VARCHAR(10) PRIMARY KEY,
    tier_name ENUM('REGULAR', 'SILVER', 'GOLD') NOT NULL,
    discount FLOAT(5),
    max_deposit FLOAT(10)
);

INSERT INTO membership_tier
VALUES
('MT_1','REGULAR',0.0, 250000),
('MT_2','SILVER',0.0, 500000),
('MT_3','GOLD',0.0, 1000000);

CREATE TABLE equipment_category(
  category_id VARCHAR(10) NOT NULL PRIMARY KEY,
  name VARCHAR(20),
  description VARCHAR(50) NULL,
  base_price_factor float(5) NULL,
  weekend_multiplier float(5) NULL,
  long_rental_discount_rate float(5) NULL,
  default_late_fee_per_day float(10) NULL
);

CREATE TABLE equipment(
  equipment_id VARCHAR(10) NOT NULL PRIMARY KEY,
  branch_id VARCHAR(10),
  category_id VARCHAR(10),
  brand VARCHAR(10),
  model VARCHAR(50),
  purchase_year int(5),
  base_daily_price float(10),
  security_deposit_amount float(10),
  status ENUM( 'AVAILABLE', 'RESERVED', 'RENTED', 'MAINTENANCE'),
  FOREIGN KEY(branch_id) REFERENCES branch(branch_id),
  FOREIGN KEY(category_id) REFERENCES equipment_category(category_id)
);

CREATE TABLE customer(
  customer_id VARCHAR(10) NOT NULL PRIMARY KEY,
  name VARCHAR(30),
  nic_passport VARCHAR(30),
  contact VARCHAR(15),
  email VARCHAR(30),
  address VARCHAR(30),
  membership_tier_id VARCHAR(10),
  deposit FLOAT(10) DEFAULT 0,
  FOREIGN KEY(membership_tier_id) REFERENCES membership_tier(tier_id)
);

CREATE TABLE reservation(
  reservation_id VARCHAR(10) NOT NULL PRIMARY KEY,
  customer_id VARCHAR(10),
  equipment_id VARCHAR(10),
  branch_id VARCHAR(10),
  reservation_date date,
  start_date date,
  end_date date,
  status ENUM( 'PENDING', 'COMPLETED', 'CANCELLED'),
  FOREIGN KEY(branch_id) REFERENCES branch(branch_id),
  FOREIGN KEY(customer_id) REFERENCES customer(customer_id),
  FOREIGN KEY(equipment_id) REFERENCES equipment(equipment_id)
);

CREATE TABLE customer_deposit(
  customer_id VARCHAR(10) NOT NULL PRIMARY KEY,
  deposit_amount float(10),
  FOREIGN KEY(customer_id) REFERENCES customer(customer_id),
);





